#lang racket
(require racket/class
         racket/set
         lazy/force
         racket/promise
         racket/serialize
         compatibility/mlist
         (only-in racket/list shuffle argmax))

;; Реализация минимакса с альфа-бета отсечением
(define (minimax tree)
  (define (minimax-h node alpha beta max-player)
    (define (next-max x v)
      (if (or (null? x) (<= beta v)) 
                v
                (next-max (cdr x)
                      (max v (minimax-h (car x) v beta (not max-player)))))
    )
    (define (next-min x v)
      (if (or (null? x) (<= v alpha)) 
                v
                (next-min (cdr x)
                      (min v (minimax-h (car x) alpha v (not max-player)))))
    )
    (cond 
         ((number? node) node)
         ((null? node) 0.0)
         (max-player (next-max node alpha))
         (else (next-min node beta)))
          
  )
  (!(minimax-h tree -inf.0 +inf.0 #f))
 )

; класс игры - фундаментальный в нашей программе
(define game%
  (class object%
    (super-new)
 
    ;; виртуальные методы для задания правил игры
    (init-field
     my-win?         ; State -> Bool
     my-loss?        ; State -> Bool
     draw-game?      ; State -> Bool
     my-move         ; State Move -> State
     opponent-move   ; State Move -> State
     possible-moves  ; State -> (list Move)
     show-state)     ; State -> Any

    
    ; optimal-move :: State -> Move
    ;; выбор оптимального хода по минимаксу 
    ;; из нескольких оптимальных выбирается один случайно
    (define/public ((optimal-move look-ahead player_color) S)
      (!(argmax (lambda (m) (!(minimax (game-tree S m look-ahead player_color))))
                (shuffle (possible-moves S)))))

    ; game-tree :: State -> (Move -> (Tree of Real))
    (define (game-tree St m look-ahead player_color)
    ; функция, строящая закольцованный список из пары элементов
      (define (help a b) (begin (define l (mlist a b a)) (set-mcdr! l (mcons b l)) l))
      (define (new-ply moves i s)
        (cond ((my-win? s) +inf.0) ; в выигрышной позиции
              ((my-loss? s) -inf.0) ; в проигрышной
              ((draw-game? s)     0) ; при ничье
              ((>= i look-ahead)  (f-h player_color s)) ; если исчерпана глубина
              (else (map (lambda (x) (new-ply (mcdr moves) (+ 1 i)
                                              ((mcar moves) s x)))
                         (possible-moves s)))))
      (new-ply (help opponent-move my-move) 1 (my-move St m)))
    
    ;; make-move :: State (State -> Move) -> (Move State Symbol)
    (define/public (make-move S move)
      (cond
        ((my-loss? S)   (values '() S 'loss))         
        ((draw-game? S) (values '() S 'draw))   
        (else (let* ((m* (! (move S)))
                     (S* (my-move S m*)))
                (cond
                  ((my-win? S*)    (values m* S* 'win)) 
                  ((draw-game? S*) (values m* S* 'draw))
                  (else            (values m* S* 'next))))))
    )
    
  )
)


;; Реализация класса игрока
;; Параметр `game` указывает, в какая игра решается.
(define (interactive-player game)
  (class game
    (super-new)

    (inherit-field show-state)
    (inherit make-move optimal-move)
    (init-field
     name
     player-color
     [opponent 'undefined]
     [look-ahead 4]
     [move-method (optimal-move look-ahead player-color)])
    
    (define/public (your-turn S)
      (define-values (m S* status) (make-move S move-method))
      (printf "\n~a makes move ~a\n" name m)
      (show-state S*)
      (case status
         ['stop (displayln "The game was interrupted.")]
         ['win  (printf "~a wins the game!" name)]
         ['loss (printf "~a lost the game!" name)]
         ['draw (printf "Draw!")]
         [else (send opponent your-turn S*)])
    )
  )
)

;; макрос для описания партнеров в игре
(define-syntax-rule 
  (define-partners game (A #:win A-wins #:move A-move) 
                        (B #:win B-wins #:move B-move))
  (begin
    (define A (class game 
                (super-new 
                 [my-win?  A-wins]
                 [my-loss? B-wins]
                 [my-move  A-move]
                 [opponent-move B-move])))
    (define B (class game 
                (super-new 
                 [my-win?  B-wins]
                 [my-loss? A-wins]
                 [my-move  B-move]
                 [opponent-move A-move])))))

;; функция, инициализирующая игру
(define (start-game p1 p2 initial-state)
  (set-field! opponent p1 p2)
  (set-field! opponent p2 p1)
  (send p1 your-turn initial-state))


;; ДОСКА

(struct board (bl wh) #:transparent)

(define empty-board (board (set) (set)))

;; геттеры
(define bl-get board-bl)
(define wh-get board-wh)

;;ход игрока
(define (bl-move b m) (board (set-add (bl-get b) m) (wh-get b)))
(define (wh-move b m) (board (bl-get b) (set-add (wh-get b) m)))

;;вывод доски на экран
(define (show-board b)
  (for ([i '(15 14 13 12 11 10 9 8 7 6 5 4 3 2 1)])
    (if (< i 10)
        (printf "~a  " i)
        (printf "~a " i))
    (for ([j '(1 2 3 4 5 6 7 8 9 10 11 12 13 14 15)])
      (display (cond
                 ((set-member? (bl-get b) (list j i)) "|bl")
                 ((set-member? (wh-get b) (list j i)) "|wh")
                 (else "|  "))))
    (display "|\n"))
  (displayln "    1  2  3  4  5  6  7  8  9  10 11 12 13 14 15    "))


;(define all-cells ...) - ниже

(define (free-cells b) (set-subtract all-cells (bl-get b) (wh-get b)))

;(define winning-positions ...) - ниже

(define ((wins? getter) b) (ormap (lambda (x) (subset? x (getter b))) winning-positions))



;--------------------- Эвристическая оценка -----------------------------------------------------------------------------
; получить все ячейки игровой доски, не занятые ходами одного из игроков
(define (open-4-cells bl/wh_getter b)
  (set-subtract all-cells (bl/wh_getter b)))

; получить количество выигрышных линий, открытых для одного из игроков
; в lambda result is y
(define (count-open-4 l)
  (foldl (lambda (x y) (if (subset? x l) (+ 1 y) y)) 0 winning-positions))


; функция эвристической оценки позиции
; из количества выигрышных линий, открытых для одного игрока, вычитается количество выигрышных линий, открытых для другого игрока
(define (f-h player_color s)
  (define val (- (count-open-4 (open-4-cells wh-get s)) (count-open-4 (open-4-cells bl-get s) )))
  (if (= player_color 0)
      val
      (- val)
  )
)



(define (input-move m)
  (cond ((equal? m 'q) (exit))
        ((set-member? all-cells m) m)
        (else (input-move (read))))
)
    



(define renju%
  (class game%
    (super-new
      [draw-game?       (compose set-empty? free-cells)]
      [possible-moves   (compose set->list free-cells)]
      [show-state       show-board]
    )
  )
)  



(define-partners renju%
  (bl% #:win (wins? bl-get) #:move bl-move)
  (wh% #:win (wins? wh-get) #:move wh-move))


; for input game -----------
(define user-A   (new (force (interactive-player bl%))
                      [name "BLACK"]
                      [player-color 0]
                      [move-method         (lambda (b) (input-move (read)))]))

(define user-B   (new (force (interactive-player wh%))
                      [name "WHITE"]
                      [player-color 1]
                      [move-method         (lambda (b) (input-move (read)))]))

;(!(start-game user-A user-B empty-board)) 




; for game with AI ---------
(define player-A (new (force (interactive-player bl%))
                      [name "BLACK"]
                      [look-ahead 1]
                      [player-color 0]))

(define player-B (new (force (interactive-player wh%))
                      [name "WHITE"]
                      [look-ahead 1]
                      [player-color 1]))

;(!(start-game player-A player-B empty-board))






(define all-cells
  
  (set  '(1 1) '(1 2) '(1 3) '(1 4) '(1 5) '(1 6) '(1 7) '(1 8) '(1 9) '(1 10) '(1 11) '(1 12) '(1 13) '(1 14) '(1 15) 
        '(2 1) '(2 2) '(2 3) '(2 4) '(2 5) '(2 6) '(2 7) '(2 8) '(2 9) '(2 10) '(2 11) '(2 12) '(2 13) '(2 14) '(2 15) 
        '(3 1) '(3 2) '(3 3) '(3 4) '(3 5) '(3 6) '(3 7) '(3 8) '(3 9) '(3 10) '(3 11) '(3 12) '(3 13) '(3 14) '(3 15) 
        '(4 1) '(4 2) '(4 3) '(4 4) '(4 5) '(4 6) '(4 7) '(4 8) '(4 9) '(4 10) '(4 11) '(4 12) '(4 13) '(4 14) '(4 15) 
        '(5 1) '(5 2) '(5 3) '(5 4) '(5 5) '(5 6) '(5 7) '(5 8) '(5 9) '(5 10) '(5 11) '(5 12) '(5 13) '(5 14) '(5 15) 
        '(6 1) '(6 2) '(6 3) '(6 4) '(6 5) '(6 6) '(6 7) '(6 8) '(6 9) '(6 10) '(6 11) '(6 12) '(6 13) '(6 14) '(6 15) 
        '(7 1) '(7 2) '(7 3) '(7 4) '(7 5) '(7 6) '(7 7) '(7 8) '(7 9) '(7 10) '(7 11) '(7 12) '(7 13) '(7 14) '(7 15) 
        '(8 1) '(8 2) '(8 3) '(8 4) '(8 5) '(8 6) '(8 7) '(8 8) '(8 9) '(8 10) '(8 11) '(8 12) '(8 13) '(8 14) '(8 15) 
        '(9 1) '(9 2) '(9 3) '(9 4) '(9 5) '(9 6) '(9 7) '(9 8) '(9 9) '(9 10) '(9 11) '(9 12) '(9 13) '(9 14) '(9 15) 
        '(10 1) '(10 2) '(10 3) '(10 4) '(10 5) '(10 6) '(10 7) '(10 8) '(10 9) '(10 10) '(10 11) '(10 12) '(10 13) '(10 14) '(10 15) 
        '(11 1) '(11 2) '(11 3) '(11 4) '(11 5) '(11 6) '(11 7) '(11 8) '(11 9) '(11 10) '(11 11) '(11 12) '(11 13) '(11 14) '(11 15) 
        '(12 1) '(12 2) '(12 3) '(12 4) '(12 5) '(12 6) '(12 7) '(12 8) '(12 9) '(12 10) '(12 11) '(12 12) '(12 13) '(12 14) '(12 15) 
        '(13 1) '(13 2) '(13 3) '(13 4) '(13 5) '(13 6) '(13 7) '(13 8) '(13 9) '(13 10) '(13 11) '(13 12) '(13 13) '(13 14) '(13 15) 
        '(14 1) '(14 2) '(14 3) '(14 4) '(14 5) '(14 6) '(14 7) '(14 8) '(14 9) '(14 10) '(14 11) '(14 12) '(14 13) '(14 14) '(14 15) 
        '(15 1) '(15 2) '(15 3) '(15 4) '(15 5) '(15 6) '(15 7) '(15 8) '(15 9) '(15 10) '(15 11) '(15 12) '(15 13) '(15 14) '(15 15)
   )
)


(define winning-positions
  (list
   ; по вертикали:
   (set '(1 1) '(1 2) '(1 3) '(1 4) '(1 5) )
   (set '(1 2) '(1 3) '(1 4) '(1 5) '(1 6) )
   (set '(1 3) '(1 4) '(1 5) '(1 6) '(1 7) )
   (set '(1 4) '(1 5) '(1 6) '(1 7) '(1 8) )
   (set '(1 5) '(1 6) '(1 7) '(1 8) '(1 9) )
   (set '(1 6) '(1 7) '(1 8) '(1 9) '(1 10) )
   (set '(1 7) '(1 8) '(1 9) '(1 10) '(1 11) )
   (set '(1 8) '(1 9) '(1 10) '(1 11) '(1 12) )
   (set '(1 9) '(1 10) '(1 11) '(1 12) '(1 13) )
   (set '(1 10) '(1 11) '(1 12) '(1 13) '(1 14) )
   (set '(1 11) '(1 12) '(1 13) '(1 14) '(1 15) )
   (set '(2 1) '(2 2) '(2 3) '(2 4) '(2 5) )
   (set '(2 2) '(2 3) '(2 4) '(2 5) '(2 6) )
   (set '(2 3) '(2 4) '(2 5) '(2 6) '(2 7) )
   (set '(2 4) '(2 5) '(2 6) '(2 7) '(2 8) )
   (set '(2 5) '(2 6) '(2 7) '(2 8) '(2 9) )
   (set '(2 6) '(2 7) '(2 8) '(2 9) '(2 10) )
   (set '(2 7) '(2 8) '(2 9) '(2 10) '(2 11) )
   (set '(2 8) '(2 9) '(2 10) '(2 11) '(2 12) )
   (set '(2 9) '(2 10) '(2 11) '(2 12) '(2 13) )
   (set '(2 10) '(2 11) '(2 12) '(2 13) '(2 14) )
   (set '(2 11) '(2 12) '(2 13) '(2 14) '(2 15) )
   (set '(3 1) '(3 2) '(3 3) '(3 4) '(3 5) )
   (set '(3 2) '(3 3) '(3 4) '(3 5) '(3 6) )
   (set '(3 3) '(3 4) '(3 5) '(3 6) '(3 7) )
   (set '(3 4) '(3 5) '(3 6) '(3 7) '(3 8) )
   (set '(3 5) '(3 6) '(3 7) '(3 8) '(3 9) )
   (set '(3 6) '(3 7) '(3 8) '(3 9) '(3 10) )
   (set '(3 7) '(3 8) '(3 9) '(3 10) '(3 11) )
   (set '(3 8) '(3 9) '(3 10) '(3 11) '(3 12) )
   (set '(3 9) '(3 10) '(3 11) '(3 12) '(3 13) )
   (set '(3 10) '(3 11) '(3 12) '(3 13) '(3 14) )
   (set '(3 11) '(3 12) '(3 13) '(3 14) '(3 15) )
   (set '(4 1) '(4 2) '(4 3) '(4 4) '(4 5) )
   (set '(4 2) '(4 3) '(4 4) '(4 5) '(4 6) )
   (set '(4 3) '(4 4) '(4 5) '(4 6) '(4 7) )
   (set '(4 4) '(4 5) '(4 6) '(4 7) '(4 8) )
   (set '(4 5) '(4 6) '(4 7) '(4 8) '(4 9) )
   (set '(4 6) '(4 7) '(4 8) '(4 9) '(4 10) )
   (set '(4 7) '(4 8) '(4 9) '(4 10) '(4 11) )
   (set '(4 8) '(4 9) '(4 10) '(4 11) '(4 12) )
   (set '(4 9) '(4 10) '(4 11) '(4 12) '(4 13) )
   (set '(4 10) '(4 11) '(4 12) '(4 13) '(4 14) )
   (set '(4 11) '(4 12) '(4 13) '(4 14) '(4 15) )
   (set '(5 1) '(5 2) '(5 3) '(5 4) '(5 5) )
   (set '(5 2) '(5 3) '(5 4) '(5 5) '(5 6) )
   (set '(5 3) '(5 4) '(5 5) '(5 6) '(5 7) )
   (set '(5 4) '(5 5) '(5 6) '(5 7) '(5 8) )
   (set '(5 5) '(5 6) '(5 7) '(5 8) '(5 9) )
   (set '(5 6) '(5 7) '(5 8) '(5 9) '(5 10) )
   (set '(5 7) '(5 8) '(5 9) '(5 10) '(5 11) )
   (set '(5 8) '(5 9) '(5 10) '(5 11) '(5 12) )
   (set '(5 9) '(5 10) '(5 11) '(5 12) '(5 13) )
   (set '(5 10) '(5 11) '(5 12) '(5 13) '(5 14) )
   (set '(5 11) '(5 12) '(5 13) '(5 14) '(5 15) )
   (set '(6 1) '(6 2) '(6 3) '(6 4) '(6 5) )
   (set '(6 2) '(6 3) '(6 4) '(6 5) '(6 6) )
   (set '(6 3) '(6 4) '(6 5) '(6 6) '(6 7) )
   (set '(6 4) '(6 5) '(6 6) '(6 7) '(6 8) )
   (set '(6 5) '(6 6) '(6 7) '(6 8) '(6 9) )
   (set '(6 6) '(6 7) '(6 8) '(6 9) '(6 10) )
   (set '(6 7) '(6 8) '(6 9) '(6 10) '(6 11) )
   (set '(6 8) '(6 9) '(6 10) '(6 11) '(6 12) )
   (set '(6 9) '(6 10) '(6 11) '(6 12) '(6 13) )
   (set '(6 10) '(6 11) '(6 12) '(6 13) '(6 14) )
   (set '(6 11) '(6 12) '(6 13) '(6 14) '(6 15) )
   (set '(7 1) '(7 2) '(7 3) '(7 4) '(7 5) )
   (set '(7 2) '(7 3) '(7 4) '(7 5) '(7 6) )
   (set '(7 3) '(7 4) '(7 5) '(7 6) '(7 7) )
   (set '(7 4) '(7 5) '(7 6) '(7 7) '(7 8) )
   (set '(7 5) '(7 6) '(7 7) '(7 8) '(7 9) )
   (set '(7 6) '(7 7) '(7 8) '(7 9) '(7 10) )
   (set '(7 7) '(7 8) '(7 9) '(7 10) '(7 11) )
   (set '(7 8) '(7 9) '(7 10) '(7 11) '(7 12) )
   (set '(7 9) '(7 10) '(7 11) '(7 12) '(7 13) )
   (set '(7 10) '(7 11) '(7 12) '(7 13) '(7 14) )
   (set '(7 11) '(7 12) '(7 13) '(7 14) '(7 15) )
   (set '(8 1) '(8 2) '(8 3) '(8 4) '(8 5) )
   (set '(8 2) '(8 3) '(8 4) '(8 5) '(8 6) )
   (set '(8 3) '(8 4) '(8 5) '(8 6) '(8 7) )
   (set '(8 4) '(8 5) '(8 6) '(8 7) '(8 8) )
   (set '(8 5) '(8 6) '(8 7) '(8 8) '(8 9) )
   (set '(8 6) '(8 7) '(8 8) '(8 9) '(8 10) )
   (set '(8 7) '(8 8) '(8 9) '(8 10) '(8 11) )
   (set '(8 8) '(8 9) '(8 10) '(8 11) '(8 12) )
   (set '(8 9) '(8 10) '(8 11) '(8 12) '(8 13) )
   (set '(8 10) '(8 11) '(8 12) '(8 13) '(8 14) )
   (set '(8 11) '(8 12) '(8 13) '(8 14) '(8 15) )
   (set '(9 1) '(9 2) '(9 3) '(9 4) '(9 5) )
   (set '(9 2) '(9 3) '(9 4) '(9 5) '(9 6) )
   (set '(9 3) '(9 4) '(9 5) '(9 6) '(9 7) )
   (set '(9 4) '(9 5) '(9 6) '(9 7) '(9 8) )
   (set '(9 5) '(9 6) '(9 7) '(9 8) '(9 9) )
   (set '(9 6) '(9 7) '(9 8) '(9 9) '(9 10) )
   (set '(9 7) '(9 8) '(9 9) '(9 10) '(9 11) )
   (set '(9 8) '(9 9) '(9 10) '(9 11) '(9 12) )
   (set '(9 9) '(9 10) '(9 11) '(9 12) '(9 13) )
   (set '(9 10) '(9 11) '(9 12) '(9 13) '(9 14) )
   (set '(9 11) '(9 12) '(9 13) '(9 14) '(9 15) )
   (set '(10 1) '(10 2) '(10 3) '(10 4) '(10 5) )
   (set '(10 2) '(10 3) '(10 4) '(10 5) '(10 6) )
   (set '(10 3) '(10 4) '(10 5) '(10 6) '(10 7) )
   (set '(10 4) '(10 5) '(10 6) '(10 7) '(10 8) )
   (set '(10 5) '(10 6) '(10 7) '(10 8) '(10 9) )
   (set '(10 6) '(10 7) '(10 8) '(10 9) '(10 10) )
   (set '(10 7) '(10 8) '(10 9) '(10 10) '(10 11) )
   (set '(10 8) '(10 9) '(10 10) '(10 11) '(10 12) )
   (set '(10 9) '(10 10) '(10 11) '(10 12) '(10 13) )
   (set '(10 10) '(10 11) '(10 12) '(10 13) '(10 14) )
   (set '(10 11) '(10 12) '(10 13) '(10 14) '(10 15) )
   (set '(11 1) '(11 2) '(11 3) '(11 4) '(11 5) )
   (set '(11 2) '(11 3) '(11 4) '(11 5) '(11 6) )
   (set '(11 3) '(11 4) '(11 5) '(11 6) '(11 7) )
   (set '(11 4) '(11 5) '(11 6) '(11 7) '(11 8) )
   (set '(11 5) '(11 6) '(11 7) '(11 8) '(11 9) )
   (set '(11 6) '(11 7) '(11 8) '(11 9) '(11 10) )
   (set '(11 7) '(11 8) '(11 9) '(11 10) '(11 11) )
   (set '(11 8) '(11 9) '(11 10) '(11 11) '(11 12) )
   (set '(11 9) '(11 10) '(11 11) '(11 12) '(11 13) )
   (set '(11 10) '(11 11) '(11 12) '(11 13) '(11 14) )
   (set '(11 11) '(11 12) '(11 13) '(11 14) '(11 15) )
   (set '(12 1) '(12 2) '(12 3) '(12 4) '(12 5) )
   (set '(12 2) '(12 3) '(12 4) '(12 5) '(12 6) )
   (set '(12 3) '(12 4) '(12 5) '(12 6) '(12 7) )
   (set '(12 4) '(12 5) '(12 6) '(12 7) '(12 8) )
   (set '(12 5) '(12 6) '(12 7) '(12 8) '(12 9) )
   (set '(12 6) '(12 7) '(12 8) '(12 9) '(12 10) )
   (set '(12 7) '(12 8) '(12 9) '(12 10) '(12 11) )
   (set '(12 8) '(12 9) '(12 10) '(12 11) '(12 12) )
   (set '(12 9) '(12 10) '(12 11) '(12 12) '(12 13) )
   (set '(12 10) '(12 11) '(12 12) '(12 13) '(12 14) )
   (set '(12 11) '(12 12) '(12 13) '(12 14) '(12 15) )
   (set '(13 1) '(13 2) '(13 3) '(13 4) '(13 5) )
   (set '(13 2) '(13 3) '(13 4) '(13 5) '(13 6) )
   (set '(13 3) '(13 4) '(13 5) '(13 6) '(13 7) )
   (set '(13 4) '(13 5) '(13 6) '(13 7) '(13 8) )
   (set '(13 5) '(13 6) '(13 7) '(13 8) '(13 9) )
   (set '(13 6) '(13 7) '(13 8) '(13 9) '(13 10) )
   (set '(13 7) '(13 8) '(13 9) '(13 10) '(13 11) )
   (set '(13 8) '(13 9) '(13 10) '(13 11) '(13 12) )
   (set '(13 9) '(13 10) '(13 11) '(13 12) '(13 13) )
   (set '(13 10) '(13 11) '(13 12) '(13 13) '(13 14) )
   (set '(13 11) '(13 12) '(13 13) '(13 14) '(13 15) )
   (set '(14 1) '(14 2) '(14 3) '(14 4) '(14 5) )
   (set '(14 2) '(14 3) '(14 4) '(14 5) '(14 6) )
   (set '(14 3) '(14 4) '(14 5) '(14 6) '(14 7) )
   (set '(14 4) '(14 5) '(14 6) '(14 7) '(14 8) )
   (set '(14 5) '(14 6) '(14 7) '(14 8) '(14 9) )
   (set '(14 6) '(14 7) '(14 8) '(14 9) '(14 10) )
   (set '(14 7) '(14 8) '(14 9) '(14 10) '(14 11) )
   (set '(14 8) '(14 9) '(14 10) '(14 11) '(14 12) )
   (set '(14 9) '(14 10) '(14 11) '(14 12) '(14 13) )
   (set '(14 10) '(14 11) '(14 12) '(14 13) '(14 14) )
   (set '(14 11) '(14 12) '(14 13) '(14 14) '(14 15) )
   (set '(15 1) '(15 2) '(15 3) '(15 4) '(15 5) )
   (set '(15 2) '(15 3) '(15 4) '(15 5) '(15 6) )
   (set '(15 3) '(15 4) '(15 5) '(15 6) '(15 7) )
   (set '(15 4) '(15 5) '(15 6) '(15 7) '(15 8) )
   (set '(15 5) '(15 6) '(15 7) '(15 8) '(15 9) )
   (set '(15 6) '(15 7) '(15 8) '(15 9) '(15 10) )
   (set '(15 7) '(15 8) '(15 9) '(15 10) '(15 11) )
   (set '(15 8) '(15 9) '(15 10) '(15 11) '(15 12) )
   (set '(15 9) '(15 10) '(15 11) '(15 12) '(15 13) )
   (set '(15 10) '(15 11) '(15 12) '(15 13) '(15 14) )
   (set '(15 11) '(15 12) '(15 13) '(15 14) '(15 15) )

   ; по горизонтали:
   (set '(1 1) '(2 1) '(3 1) '(4 1) '(5 1) )
   (set '(2 1) '(3 1) '(4 1) '(5 1) '(6 1) )
   (set '(3 1) '(4 1) '(5 1) '(6 1) '(7 1) )
   (set '(4 1) '(5 1) '(6 1) '(7 1) '(8 1) )
   (set '(5 1) '(6 1) '(7 1) '(8 1) '(9 1) )
   (set '(6 1) '(7 1) '(8 1) '(9 1) '(10 1) )
   (set '(7 1) '(8 1) '(9 1) '(10 1) '(11 1) )
   (set '(8 1) '(9 1) '(10 1) '(11 1) '(12 1) )
   (set '(9 1) '(10 1) '(11 1) '(12 1) '(13 1) )
   (set '(10 1) '(11 1) '(12 1) '(13 1) '(14 1) )
   (set '(11 1) '(12 1) '(13 1) '(14 1) '(15 1) )
   (set '(1 2) '(2 2) '(3 2) '(4 2) '(5 2) )
   (set '(2 2) '(3 2) '(4 2) '(5 2) '(6 2) )
   (set '(3 2) '(4 2) '(5 2) '(6 2) '(7 2) )
   (set '(4 2) '(5 2) '(6 2) '(7 2) '(8 2) )
   (set '(5 2) '(6 2) '(7 2) '(8 2) '(9 2) )
   (set '(6 2) '(7 2) '(8 2) '(9 2) '(10 2) )
   (set '(7 2) '(8 2) '(9 2) '(10 2) '(11 2) )
   (set '(8 2) '(9 2) '(10 2) '(11 2) '(12 2) )
   (set '(9 2) '(10 2) '(11 2) '(12 2) '(13 2) )
   (set '(10 2) '(11 2) '(12 2) '(13 2) '(14 2) )
   (set '(11 2) '(12 2) '(13 2) '(14 2) '(15 2) )
   (set '(1 3) '(2 3) '(3 3) '(4 3) '(5 3) )
   (set '(2 3) '(3 3) '(4 3) '(5 3) '(6 3) )
   (set '(3 3) '(4 3) '(5 3) '(6 3) '(7 3) )
   (set '(4 3) '(5 3) '(6 3) '(7 3) '(8 3) )
   (set '(5 3) '(6 3) '(7 3) '(8 3) '(9 3) )
   (set '(6 3) '(7 3) '(8 3) '(9 3) '(10 3) )
   (set '(7 3) '(8 3) '(9 3) '(10 3) '(11 3) )
   (set '(8 3) '(9 3) '(10 3) '(11 3) '(12 3) )
   (set '(9 3) '(10 3) '(11 3) '(12 3) '(13 3) )
   (set '(10 3) '(11 3) '(12 3) '(13 3) '(14 3) )
   (set '(11 3) '(12 3) '(13 3) '(14 3) '(15 3) )
   (set '(1 4) '(2 4) '(3 4) '(4 4) '(5 4) )
   (set '(2 4) '(3 4) '(4 4) '(5 4) '(6 4) )
   (set '(3 4) '(4 4) '(5 4) '(6 4) '(7 4) )
   (set '(4 4) '(5 4) '(6 4) '(7 4) '(8 4) )
   (set '(5 4) '(6 4) '(7 4) '(8 4) '(9 4) )
   (set '(6 4) '(7 4) '(8 4) '(9 4) '(10 4) )
   (set '(7 4) '(8 4) '(9 4) '(10 4) '(11 4) )
   (set '(8 4) '(9 4) '(10 4) '(11 4) '(12 4) )
   (set '(9 4) '(10 4) '(11 4) '(12 4) '(13 4) )
   (set '(10 4) '(11 4) '(12 4) '(13 4) '(14 4) )
   (set '(11 4) '(12 4) '(13 4) '(14 4) '(15 4) )
   (set '(1 5) '(2 5) '(3 5) '(4 5) '(5 5) )
   (set '(2 5) '(3 5) '(4 5) '(5 5) '(6 5) )
   (set '(3 5) '(4 5) '(5 5) '(6 5) '(7 5) )
   (set '(4 5) '(5 5) '(6 5) '(7 5) '(8 5) )
   (set '(5 5) '(6 5) '(7 5) '(8 5) '(9 5) )
   (set '(6 5) '(7 5) '(8 5) '(9 5) '(10 5) )
   (set '(7 5) '(8 5) '(9 5) '(10 5) '(11 5) )
   (set '(8 5) '(9 5) '(10 5) '(11 5) '(12 5) )
   (set '(9 5) '(10 5) '(11 5) '(12 5) '(13 5) )
   (set '(10 5) '(11 5) '(12 5) '(13 5) '(14 5) )
   (set '(11 5) '(12 5) '(13 5) '(14 5) '(15 5) )
   (set '(1 6) '(2 6) '(3 6) '(4 6) '(5 6) )
   (set '(2 6) '(3 6) '(4 6) '(5 6) '(6 6) )
   (set '(3 6) '(4 6) '(5 6) '(6 6) '(7 6) )
   (set '(4 6) '(5 6) '(6 6) '(7 6) '(8 6) )
   (set '(5 6) '(6 6) '(7 6) '(8 6) '(9 6) )
   (set '(6 6) '(7 6) '(8 6) '(9 6) '(10 6) )
   (set '(7 6) '(8 6) '(9 6) '(10 6) '(11 6) )
   (set '(8 6) '(9 6) '(10 6) '(11 6) '(12 6) )
   (set '(9 6) '(10 6) '(11 6) '(12 6) '(13 6) )
   (set '(10 6) '(11 6) '(12 6) '(13 6) '(14 6) )
   (set '(11 6) '(12 6) '(13 6) '(14 6) '(15 6) )
   (set '(1 7) '(2 7) '(3 7) '(4 7) '(5 7) )
   (set '(2 7) '(3 7) '(4 7) '(5 7) '(6 7) )
   (set '(3 7) '(4 7) '(5 7) '(6 7) '(7 7) )
   (set '(4 7) '(5 7) '(6 7) '(7 7) '(8 7) )
   (set '(5 7) '(6 7) '(7 7) '(8 7) '(9 7) )
   (set '(6 7) '(7 7) '(8 7) '(9 7) '(10 7) )
   (set '(7 7) '(8 7) '(9 7) '(10 7) '(11 7) )
   (set '(8 7) '(9 7) '(10 7) '(11 7) '(12 7) )
   (set '(9 7) '(10 7) '(11 7) '(12 7) '(13 7) )
   (set '(10 7) '(11 7) '(12 7) '(13 7) '(14 7) )
   (set '(11 7) '(12 7) '(13 7) '(14 7) '(15 7) )
   (set '(1 8) '(2 8) '(3 8) '(4 8) '(5 8) )
   (set '(2 8) '(3 8) '(4 8) '(5 8) '(6 8) )
   (set '(3 8) '(4 8) '(5 8) '(6 8) '(7 8) )
   (set '(4 8) '(5 8) '(6 8) '(7 8) '(8 8) )
   (set '(5 8) '(6 8) '(7 8) '(8 8) '(9 8) )
   (set '(6 8) '(7 8) '(8 8) '(9 8) '(10 8) )
   (set '(7 8) '(8 8) '(9 8) '(10 8) '(11 8) )
   (set '(8 8) '(9 8) '(10 8) '(11 8) '(12 8) )
   (set '(9 8) '(10 8) '(11 8) '(12 8) '(13 8) )
   (set '(10 8) '(11 8) '(12 8) '(13 8) '(14 8) )
   (set '(11 8) '(12 8) '(13 8) '(14 8) '(15 8) )
   (set '(1 9) '(2 9) '(3 9) '(4 9) '(5 9) )
   (set '(2 9) '(3 9) '(4 9) '(5 9) '(6 9) )
   (set '(3 9) '(4 9) '(5 9) '(6 9) '(7 9) )
   (set '(4 9) '(5 9) '(6 9) '(7 9) '(8 9) )
   (set '(5 9) '(6 9) '(7 9) '(8 9) '(9 9) )
   (set '(6 9) '(7 9) '(8 9) '(9 9) '(10 9) )
   (set '(7 9) '(8 9) '(9 9) '(10 9) '(11 9) )
   (set '(8 9) '(9 9) '(10 9) '(11 9) '(12 9) )
   (set '(9 9) '(10 9) '(11 9) '(12 9) '(13 9) )
   (set '(10 9) '(11 9) '(12 9) '(13 9) '(14 9) )
   (set '(11 9) '(12 9) '(13 9) '(14 9) '(15 9) )
   (set '(1 10) '(2 10) '(3 10) '(4 10) '(5 10) )
   (set '(2 10) '(3 10) '(4 10) '(5 10) '(6 10) )
   (set '(3 10) '(4 10) '(5 10) '(6 10) '(7 10) )
   (set '(4 10) '(5 10) '(6 10) '(7 10) '(8 10) )
   (set '(5 10) '(6 10) '(7 10) '(8 10) '(9 10) )
   (set '(6 10) '(7 10) '(8 10) '(9 10) '(10 10) )
   (set '(7 10) '(8 10) '(9 10) '(10 10) '(11 10) )
   (set '(8 10) '(9 10) '(10 10) '(11 10) '(12 10) )
   (set '(9 10) '(10 10) '(11 10) '(12 10) '(13 10) )
   (set '(10 10) '(11 10) '(12 10) '(13 10) '(14 10) )
   (set '(11 10) '(12 10) '(13 10) '(14 10) '(15 10) )
   (set '(1 11) '(2 11) '(3 11) '(4 11) '(5 11) )
   (set '(2 11) '(3 11) '(4 11) '(5 11) '(6 11) )
   (set '(3 11) '(4 11) '(5 11) '(6 11) '(7 11) )
   (set '(4 11) '(5 11) '(6 11) '(7 11) '(8 11) )
   (set '(5 11) '(6 11) '(7 11) '(8 11) '(9 11) )
   (set '(6 11) '(7 11) '(8 11) '(9 11) '(10 11) )
   (set '(7 11) '(8 11) '(9 11) '(10 11) '(11 11) )
   (set '(8 11) '(9 11) '(10 11) '(11 11) '(12 11) )
   (set '(9 11) '(10 11) '(11 11) '(12 11) '(13 11) )
   (set '(10 11) '(11 11) '(12 11) '(13 11) '(14 11) )
   (set '(11 11) '(12 11) '(13 11) '(14 11) '(15 11) )
   (set '(1 12) '(2 12) '(3 12) '(4 12) '(5 12) )
   (set '(2 12) '(3 12) '(4 12) '(5 12) '(6 12) )
   (set '(3 12) '(4 12) '(5 12) '(6 12) '(7 12) )
   (set '(4 12) '(5 12) '(6 12) '(7 12) '(8 12) )
   (set '(5 12) '(6 12) '(7 12) '(8 12) '(9 12) )
   (set '(6 12) '(7 12) '(8 12) '(9 12) '(10 12) )
   (set '(7 12) '(8 12) '(9 12) '(10 12) '(11 12) )
   (set '(8 12) '(9 12) '(10 12) '(11 12) '(12 12) )
   (set '(9 12) '(10 12) '(11 12) '(12 12) '(13 12) )
   (set '(10 12) '(11 12) '(12 12) '(13 12) '(14 12) )
   (set '(11 12) '(12 12) '(13 12) '(14 12) '(15 12) )
   (set '(1 13) '(2 13) '(3 13) '(4 13) '(5 13) )
   (set '(2 13) '(3 13) '(4 13) '(5 13) '(6 13) )
   (set '(3 13) '(4 13) '(5 13) '(6 13) '(7 13) )
   (set '(4 13) '(5 13) '(6 13) '(7 13) '(8 13) )
   (set '(5 13) '(6 13) '(7 13) '(8 13) '(9 13) )
   (set '(6 13) '(7 13) '(8 13) '(9 13) '(10 13) )
   (set '(7 13) '(8 13) '(9 13) '(10 13) '(11 13) )
   (set '(8 13) '(9 13) '(10 13) '(11 13) '(12 13) )
   (set '(9 13) '(10 13) '(11 13) '(12 13) '(13 13) )
   (set '(10 13) '(11 13) '(12 13) '(13 13) '(14 13) )
   (set '(11 13) '(12 13) '(13 13) '(14 13) '(15 13) )
   (set '(1 14) '(2 14) '(3 14) '(4 14) '(5 14) )
   (set '(2 14) '(3 14) '(4 14) '(5 14) '(6 14) )
   (set '(3 14) '(4 14) '(5 14) '(6 14) '(7 14) )
   (set '(4 14) '(5 14) '(6 14) '(7 14) '(8 14) )
   (set '(5 14) '(6 14) '(7 14) '(8 14) '(9 14) )
   (set '(6 14) '(7 14) '(8 14) '(9 14) '(10 14) )
   (set '(7 14) '(8 14) '(9 14) '(10 14) '(11 14) )
   (set '(8 14) '(9 14) '(10 14) '(11 14) '(12 14) )
   (set '(9 14) '(10 14) '(11 14) '(12 14) '(13 14) )
   (set '(10 14) '(11 14) '(12 14) '(13 14) '(14 14) )
   (set '(11 14) '(12 14) '(13 14) '(14 14) '(15 14) )
   (set '(1 15) '(2 15) '(3 15) '(4 15) '(5 15) )
   (set '(2 15) '(3 15) '(4 15) '(5 15) '(6 15) )
   (set '(3 15) '(4 15) '(5 15) '(6 15) '(7 15) )
   (set '(4 15) '(5 15) '(6 15) '(7 15) '(8 15) )
   (set '(5 15) '(6 15) '(7 15) '(8 15) '(9 15) )
   (set '(6 15) '(7 15) '(8 15) '(9 15) '(10 15) )
   (set '(7 15) '(8 15) '(9 15) '(10 15) '(11 15) )
   (set '(8 15) '(9 15) '(10 15) '(11 15) '(12 15) )
   (set '(9 15) '(10 15) '(11 15) '(12 15) '(13 15) )
   (set '(10 15) '(11 15) '(12 15) '(13 15) '(14 15) )
   (set '(11 15) '(12 15) '(13 15) '(14 15) '(15 15) )

   ; по диагонали:
   (set '(1 1) '(2 2) '(3 3) '(4 4) '(5 5) )
   (set '(2 1) '(3 2) '(4 3) '(5 4) '(6 5) )
   (set '(3 1) '(4 2) '(5 3) '(6 4) '(7 5) )
   (set '(4 1) '(5 2) '(6 3) '(7 4) '(8 5) )
   (set '(5 1) '(6 2) '(7 3) '(8 4) '(9 5) )
   (set '(6 1) '(7 2) '(8 3) '(9 4) '(10 5) )
   (set '(7 1) '(8 2) '(9 3) '(10 4) '(11 5) )
   (set '(8 1) '(9 2) '(10 3) '(11 4) '(12 5) )
   (set '(9 1) '(10 2) '(11 3) '(12 4) '(13 5) )
   (set '(10 1) '(11 2) '(12 3) '(13 4) '(14 5) )
   (set '(11 1) '(12 2) '(13 3) '(14 4) '(15 5) )
   (set '(1 2) '(2 3) '(3 4) '(4 5) '(5 6) )
   (set '(2 2) '(3 3) '(4 4) '(5 5) '(6 6) )
   (set '(3 2) '(4 3) '(5 4) '(6 5) '(7 6) )
   (set '(4 2) '(5 3) '(6 4) '(7 5) '(8 6) )
   (set '(5 2) '(6 3) '(7 4) '(8 5) '(9 6) )
   (set '(6 2) '(7 3) '(8 4) '(9 5) '(10 6) )
   (set '(7 2) '(8 3) '(9 4) '(10 5) '(11 6) )
   (set '(8 2) '(9 3) '(10 4) '(11 5) '(12 6) )
   (set '(9 2) '(10 3) '(11 4) '(12 5) '(13 6) )
   (set '(10 2) '(11 3) '(12 4) '(13 5) '(14 6) )
   (set '(11 2) '(12 3) '(13 4) '(14 5) '(15 6) )
   (set '(1 3) '(2 4) '(3 5) '(4 6) '(5 7) )
   (set '(2 3) '(3 4) '(4 5) '(5 6) '(6 7) )
   (set '(3 3) '(4 4) '(5 5) '(6 6) '(7 7) )
   (set '(4 3) '(5 4) '(6 5) '(7 6) '(8 7) )
   (set '(5 3) '(6 4) '(7 5) '(8 6) '(9 7) )
   (set '(6 3) '(7 4) '(8 5) '(9 6) '(10 7) )
   (set '(7 3) '(8 4) '(9 5) '(10 6) '(11 7) )
   (set '(8 3) '(9 4) '(10 5) '(11 6) '(12 7) )
   (set '(9 3) '(10 4) '(11 5) '(12 6) '(13 7) )
   (set '(10 3) '(11 4) '(12 5) '(13 6) '(14 7) )
   (set '(11 3) '(12 4) '(13 5) '(14 6) '(15 7) )
   (set '(1 4) '(2 5) '(3 6) '(4 7) '(5 8) )
   (set '(2 4) '(3 5) '(4 6) '(5 7) '(6 8) )
   (set '(3 4) '(4 5) '(5 6) '(6 7) '(7 8) )
   (set '(4 4) '(5 5) '(6 6) '(7 7) '(8 8) )
   (set '(5 4) '(6 5) '(7 6) '(8 7) '(9 8) )
   (set '(6 4) '(7 5) '(8 6) '(9 7) '(10 8) )
   (set '(7 4) '(8 5) '(9 6) '(10 7) '(11 8) )
   (set '(8 4) '(9 5) '(10 6) '(11 7) '(12 8) )
   (set '(9 4) '(10 5) '(11 6) '(12 7) '(13 8) )
   (set '(10 4) '(11 5) '(12 6) '(13 7) '(14 8) )
   (set '(11 4) '(12 5) '(13 6) '(14 7) '(15 8) )
   (set '(1 5) '(2 6) '(3 7) '(4 8) '(5 9) )
   (set '(2 5) '(3 6) '(4 7) '(5 8) '(6 9) )
   (set '(3 5) '(4 6) '(5 7) '(6 8) '(7 9) )
   (set '(4 5) '(5 6) '(6 7) '(7 8) '(8 9) )
   (set '(5 5) '(6 6) '(7 7) '(8 8) '(9 9) )
   (set '(6 5) '(7 6) '(8 7) '(9 8) '(10 9) )
   (set '(7 5) '(8 6) '(9 7) '(10 8) '(11 9) )
   (set '(8 5) '(9 6) '(10 7) '(11 8) '(12 9) )
   (set '(9 5) '(10 6) '(11 7) '(12 8) '(13 9) )
   (set '(10 5) '(11 6) '(12 7) '(13 8) '(14 9) )
   (set '(11 5) '(12 6) '(13 7) '(14 8) '(15 9) )
   (set '(1 6) '(2 7) '(3 8) '(4 9) '(5 10) )
   (set '(2 6) '(3 7) '(4 8) '(5 9) '(6 10) )
   (set '(3 6) '(4 7) '(5 8) '(6 9) '(7 10) )
   (set '(4 6) '(5 7) '(6 8) '(7 9) '(8 10) )
   (set '(5 6) '(6 7) '(7 8) '(8 9) '(9 10) )
   (set '(6 6) '(7 7) '(8 8) '(9 9) '(10 10) )
   (set '(7 6) '(8 7) '(9 8) '(10 9) '(11 10) )
   (set '(8 6) '(9 7) '(10 8) '(11 9) '(12 10) )
   (set '(9 6) '(10 7) '(11 8) '(12 9) '(13 10) )
   (set '(10 6) '(11 7) '(12 8) '(13 9) '(14 10) )
   (set '(11 6) '(12 7) '(13 8) '(14 9) '(15 10) )
   (set '(1 7) '(2 8) '(3 9) '(4 10) '(5 11) )
   (set '(2 7) '(3 8) '(4 9) '(5 10) '(6 11) )
   (set '(3 7) '(4 8) '(5 9) '(6 10) '(7 11) )
   (set '(4 7) '(5 8) '(6 9) '(7 10) '(8 11) )
   (set '(5 7) '(6 8) '(7 9) '(8 10) '(9 11) )
   (set '(6 7) '(7 8) '(8 9) '(9 10) '(10 11) )
   (set '(7 7) '(8 8) '(9 9) '(10 10) '(11 11) )
   (set '(8 7) '(9 8) '(10 9) '(11 10) '(12 11) )
   (set '(9 7) '(10 8) '(11 9) '(12 10) '(13 11) )
   (set '(10 7) '(11 8) '(12 9) '(13 10) '(14 11) )
   (set '(11 7) '(12 8) '(13 9) '(14 10) '(15 11) )
   (set '(1 8) '(2 9) '(3 10) '(4 11) '(5 12) )
   (set '(2 8) '(3 9) '(4 10) '(5 11) '(6 12) )
   (set '(3 8) '(4 9) '(5 10) '(6 11) '(7 12) )
   (set '(4 8) '(5 9) '(6 10) '(7 11) '(8 12) )
   (set '(5 8) '(6 9) '(7 10) '(8 11) '(9 12) )
   (set '(6 8) '(7 9) '(8 10) '(9 11) '(10 12) )
   (set '(7 8) '(8 9) '(9 10) '(10 11) '(11 12) )
   (set '(8 8) '(9 9) '(10 10) '(11 11) '(12 12) )
   (set '(9 8) '(10 9) '(11 10) '(12 11) '(13 12) )
   (set '(10 8) '(11 9) '(12 10) '(13 11) '(14 12) )
   (set '(11 8) '(12 9) '(13 10) '(14 11) '(15 12) )
   (set '(1 9) '(2 10) '(3 11) '(4 12) '(5 13) )
   (set '(2 9) '(3 10) '(4 11) '(5 12) '(6 13) )
   (set '(3 9) '(4 10) '(5 11) '(6 12) '(7 13) )
   (set '(4 9) '(5 10) '(6 11) '(7 12) '(8 13) )
   (set '(5 9) '(6 10) '(7 11) '(8 12) '(9 13) )
   (set '(6 9) '(7 10) '(8 11) '(9 12) '(10 13) )
   (set '(7 9) '(8 10) '(9 11) '(10 12) '(11 13) )
   (set '(8 9) '(9 10) '(10 11) '(11 12) '(12 13) )
   (set '(9 9) '(10 10) '(11 11) '(12 12) '(13 13) )
   (set '(10 9) '(11 10) '(12 11) '(13 12) '(14 13) )
   (set '(11 9) '(12 10) '(13 11) '(14 12) '(15 13) )
   (set '(1 10) '(2 11) '(3 12) '(4 13) '(5 14) )
   (set '(2 10) '(3 11) '(4 12) '(5 13) '(6 14) )
   (set '(3 10) '(4 11) '(5 12) '(6 13) '(7 14) )
   (set '(4 10) '(5 11) '(6 12) '(7 13) '(8 14) )
   (set '(5 10) '(6 11) '(7 12) '(8 13) '(9 14) )
   (set '(6 10) '(7 11) '(8 12) '(9 13) '(10 14) )
   (set '(7 10) '(8 11) '(9 12) '(10 13) '(11 14) )
   (set '(8 10) '(9 11) '(10 12) '(11 13) '(12 14) )
   (set '(9 10) '(10 11) '(11 12) '(12 13) '(13 14) )
   (set '(10 10) '(11 11) '(12 12) '(13 13) '(14 14) )
   (set '(11 10) '(12 11) '(13 12) '(14 13) '(15 14) )
   (set '(1 11) '(2 12) '(3 13) '(4 14) '(5 15) )
   (set '(2 11) '(3 12) '(4 13) '(5 14) '(6 15) )
   (set '(3 11) '(4 12) '(5 13) '(6 14) '(7 15) )
   (set '(4 11) '(5 12) '(6 13) '(7 14) '(8 15) )
   (set '(5 11) '(6 12) '(7 13) '(8 14) '(9 15) )
   (set '(6 11) '(7 12) '(8 13) '(9 14) '(10 15) )
   (set '(7 11) '(8 12) '(9 13) '(10 14) '(11 15) )
   (set '(8 11) '(9 12) '(10 13) '(11 14) '(12 15) )
   (set '(9 11) '(10 12) '(11 13) '(12 14) '(13 15) )
   (set '(10 11) '(11 12) '(12 13) '(13 14) '(14 15) )
   (set '(11 11) '(12 12) '(13 13) '(14 14) '(15 15) )

   (set '(5 1) '(4 2) '(3 3) '(2 4) '(1 5) )
   (set '(6 1) '(5 2) '(4 3) '(3 4) '(2 5) )
   (set '(7 1) '(6 2) '(5 3) '(4 4) '(3 5) )
   (set '(8 1) '(7 2) '(6 3) '(5 4) '(4 5) )
   (set '(9 1) '(8 2) '(7 3) '(6 4) '(5 5) )
   (set '(10 1) '(9 2) '(8 3) '(7 4) '(6 5) )
   (set '(11 1) '(10 2) '(9 3) '(8 4) '(7 5) )
   (set '(12 1) '(11 2) '(10 3) '(9 4) '(8 5) )
   (set '(13 1) '(12 2) '(11 3) '(10 4) '(9 5) )
   (set '(14 1) '(13 2) '(12 3) '(11 4) '(10 5) )
   (set '(15 1) '(14 2) '(13 3) '(12 4) '(11 5) )
   (set '(5 2) '(4 3) '(3 4) '(2 5) '(1 6) )
   (set '(6 2) '(5 3) '(4 4) '(3 5) '(2 6) )
   (set '(7 2) '(6 3) '(5 4) '(4 5) '(3 6) )
   (set '(8 2) '(7 3) '(6 4) '(5 5) '(4 6) )
   (set '(9 2) '(8 3) '(7 4) '(6 5) '(5 6) )
   (set '(10 2) '(9 3) '(8 4) '(7 5) '(6 6) )
   (set '(11 2) '(10 3) '(9 4) '(8 5) '(7 6) )
   (set '(12 2) '(11 3) '(10 4) '(9 5) '(8 6) )
   (set '(13 2) '(12 3) '(11 4) '(10 5) '(9 6) )
   (set '(14 2) '(13 3) '(12 4) '(11 5) '(10 6) )
   (set '(15 2) '(14 3) '(13 4) '(12 5) '(11 6) )
   (set '(5 3) '(4 4) '(3 5) '(2 6) '(1 7) )
   (set '(6 3) '(5 4) '(4 5) '(3 6) '(2 7) )
   (set '(7 3) '(6 4) '(5 5) '(4 6) '(3 7) )
   (set '(8 3) '(7 4) '(6 5) '(5 6) '(4 7) )
   (set '(9 3) '(8 4) '(7 5) '(6 6) '(5 7) )
   (set '(10 3) '(9 4) '(8 5) '(7 6) '(6 7) )
   (set '(11 3) '(10 4) '(9 5) '(8 6) '(7 7) )
   (set '(12 3) '(11 4) '(10 5) '(9 6) '(8 7) )
   (set '(13 3) '(12 4) '(11 5) '(10 6) '(9 7) )
   (set '(14 3) '(13 4) '(12 5) '(11 6) '(10 7) )
   (set '(15 3) '(14 4) '(13 5) '(12 6) '(11 7) )
   (set '(5 4) '(4 5) '(3 6) '(2 7) '(1 8) )
   (set '(6 4) '(5 5) '(4 6) '(3 7) '(2 8) )
   (set '(7 4) '(6 5) '(5 6) '(4 7) '(3 8) )
   (set '(8 4) '(7 5) '(6 6) '(5 7) '(4 8) )
   (set '(9 4) '(8 5) '(7 6) '(6 7) '(5 8) )
   (set '(10 4) '(9 5) '(8 6) '(7 7) '(6 8) )
   (set '(11 4) '(10 5) '(9 6) '(8 7) '(7 8) )
   (set '(12 4) '(11 5) '(10 6) '(9 7) '(8 8) )
   (set '(13 4) '(12 5) '(11 6) '(10 7) '(9 8) )
   (set '(14 4) '(13 5) '(12 6) '(11 7) '(10 8) )
   (set '(15 4) '(14 5) '(13 6) '(12 7) '(11 8) )
   (set '(5 5) '(4 6) '(3 7) '(2 8) '(1 9) )
   (set '(6 5) '(5 6) '(4 7) '(3 8) '(2 9) )
   (set '(7 5) '(6 6) '(5 7) '(4 8) '(3 9) )
   (set '(8 5) '(7 6) '(6 7) '(5 8) '(4 9) )
   (set '(9 5) '(8 6) '(7 7) '(6 8) '(5 9) )
   (set '(10 5) '(9 6) '(8 7) '(7 8) '(6 9) )
   (set '(11 5) '(10 6) '(9 7) '(8 8) '(7 9) )
   (set '(12 5) '(11 6) '(10 7) '(9 8) '(8 9) )
   (set '(13 5) '(12 6) '(11 7) '(10 8) '(9 9) )
   (set '(14 5) '(13 6) '(12 7) '(11 8) '(10 9) )
   (set '(15 5) '(14 6) '(13 7) '(12 8) '(11 9) )
   (set '(5 6) '(4 7) '(3 8) '(2 9) '(1 10) )
   (set '(6 6) '(5 7) '(4 8) '(3 9) '(2 10) )
   (set '(7 6) '(6 7) '(5 8) '(4 9) '(3 10) )
   (set '(8 6) '(7 7) '(6 8) '(5 9) '(4 10) )
   (set '(9 6) '(8 7) '(7 8) '(6 9) '(5 10) )
   (set '(10 6) '(9 7) '(8 8) '(7 9) '(6 10) )
   (set '(11 6) '(10 7) '(9 8) '(8 9) '(7 10) )
   (set '(12 6) '(11 7) '(10 8) '(9 9) '(8 10) )
   (set '(13 6) '(12 7) '(11 8) '(10 9) '(9 10) )
   (set '(14 6) '(13 7) '(12 8) '(11 9) '(10 10) )
   (set '(15 6) '(14 7) '(13 8) '(12 9) '(11 10) )
   (set '(5 7) '(4 8) '(3 9) '(2 10) '(1 11) )
   (set '(6 7) '(5 8) '(4 9) '(3 10) '(2 11) )
   (set '(7 7) '(6 8) '(5 9) '(4 10) '(3 11) )
   (set '(8 7) '(7 8) '(6 9) '(5 10) '(4 11) )
   (set '(9 7) '(8 8) '(7 9) '(6 10) '(5 11) )
   (set '(10 7) '(9 8) '(8 9) '(7 10) '(6 11) )
   (set '(11 7) '(10 8) '(9 9) '(8 10) '(7 11) )
   (set '(12 7) '(11 8) '(10 9) '(9 10) '(8 11) )
   (set '(13 7) '(12 8) '(11 9) '(10 10) '(9 11) )
   (set '(14 7) '(13 8) '(12 9) '(11 10) '(10 11) )
   (set '(15 7) '(14 8) '(13 9) '(12 10) '(11 11) )
   (set '(5 8) '(4 9) '(3 10) '(2 11) '(1 12) )
   (set '(6 8) '(5 9) '(4 10) '(3 11) '(2 12) )
   (set '(7 8) '(6 9) '(5 10) '(4 11) '(3 12) )
   (set '(8 8) '(7 9) '(6 10) '(5 11) '(4 12) )
   (set '(9 8) '(8 9) '(7 10) '(6 11) '(5 12) )
   (set '(10 8) '(9 9) '(8 10) '(7 11) '(6 12) )
   (set '(11 8) '(10 9) '(9 10) '(8 11) '(7 12) )
   (set '(12 8) '(11 9) '(10 10) '(9 11) '(8 12) )
   (set '(13 8) '(12 9) '(11 10) '(10 11) '(9 12) )
   (set '(14 8) '(13 9) '(12 10) '(11 11) '(10 12) )
   (set '(15 8) '(14 9) '(13 10) '(12 11) '(11 12) )
   (set '(5 9) '(4 10) '(3 11) '(2 12) '(1 13) )
   (set '(6 9) '(5 10) '(4 11) '(3 12) '(2 13) )
   (set '(7 9) '(6 10) '(5 11) '(4 12) '(3 13) )
   (set '(8 9) '(7 10) '(6 11) '(5 12) '(4 13) )
   (set '(9 9) '(8 10) '(7 11) '(6 12) '(5 13) )
   (set '(10 9) '(9 10) '(8 11) '(7 12) '(6 13) )
   (set '(11 9) '(10 10) '(9 11) '(8 12) '(7 13) )
   (set '(12 9) '(11 10) '(10 11) '(9 12) '(8 13) )
   (set '(13 9) '(12 10) '(11 11) '(10 12) '(9 13) )
   (set '(14 9) '(13 10) '(12 11) '(11 12) '(10 13) )
   (set '(15 9) '(14 10) '(13 11) '(12 12) '(11 13) )
   (set '(5 10) '(4 11) '(3 12) '(2 13) '(1 14) )
   (set '(6 10) '(5 11) '(4 12) '(3 13) '(2 14) )
   (set '(7 10) '(6 11) '(5 12) '(4 13) '(3 14) )
   (set '(8 10) '(7 11) '(6 12) '(5 13) '(4 14) )
   (set '(9 10) '(8 11) '(7 12) '(6 13) '(5 14) )
   (set '(10 10) '(9 11) '(8 12) '(7 13) '(6 14) )
   (set '(11 10) '(10 11) '(9 12) '(8 13) '(7 14) )
   (set '(12 10) '(11 11) '(10 12) '(9 13) '(8 14) )
   (set '(13 10) '(12 11) '(11 12) '(10 13) '(9 14) )
   (set '(14 10) '(13 11) '(12 12) '(11 13) '(10 14) )
   (set '(15 10) '(14 11) '(13 12) '(12 13) '(11 14) )
   (set '(5 11) '(4 12) '(3 13) '(2 14) '(1 15) )
   (set '(6 11) '(5 12) '(4 13) '(3 14) '(2 15) )
   (set '(7 11) '(6 12) '(5 13) '(4 14) '(3 15) )
   (set '(8 11) '(7 12) '(6 13) '(5 14) '(4 15) )
   (set '(9 11) '(8 12) '(7 13) '(6 14) '(5 15) )
   (set '(10 11) '(9 12) '(8 13) '(7 14) '(6 15) )
   (set '(11 11) '(10 12) '(9 13) '(8 14) '(7 15) )
   (set '(12 11) '(11 12) '(10 13) '(9 14) '(8 15) )
   (set '(13 11) '(12 12) '(11 13) '(10 14) '(9 15) )
   (set '(14 11) '(13 12) '(12 13) '(11 14) '(10 15) )
   (set '(15 11) '(14 12) '(13 13) '(12 14) '(11 15) )
))

